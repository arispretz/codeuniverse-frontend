<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: src/components/modals/AddKanbanTaskModal.jsx</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: src/components/modals/AddKanbanTaskModal.jsx</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @fileoverview AddKanbanTaskModal component.
 * Provides a modal form to create a new Kanban task.
 * Fetches available users, validates input fields, and submits the task to the backend.
 *
 * @module components/modals/AddKanbanTaskModal
 */

import React, { useState, useEffect } from "react";
import {
  Modal,
  Box,
  TextField,
  Button,
  Typography,
  Select,
  MenuItem,
  InputLabel,
  FormControl,
  IconButton,
} from "@mui/material";
import CloseIcon from "@mui/icons-material/Close";
import { getPublicUsers } from "../../services/userService.js";
import { createKanbanTask } from "../../services/kanbanService.js";

/**
 * AddKanbanTaskModal Component
 *
 * @function AddKanbanTaskModal
 * @param {Object} props - Component props.
 * @param {boolean} props.open - Controls whether the modal is open.
 * @param {Function} props.onClose - Callback to close the modal.
 * @param {Function} props.onTaskAdded - Callback triggered when a task is successfully added.
 * @param {string} props.listId - ID of the Kanban list where the task will be created.
 * @param {string} props.projectId - ID of the project associated with the task.
 * @returns {JSX.Element} Modal form for creating a Kanban task.
 */
const AddKanbanTaskModal = ({ open, onClose, onTaskAdded, listId, projectId }) => {
  const [form, setForm] = useState({
    title: "",
    description: "",
    status: "todo", // normalized values: "todo", "in_progress", "review", "done"
    assignedTo: "", // assigned user ID
    priority: "medium", // values: "high", "medium", "low"
    deadline: "", // date string, converted to ISO later
    tags: [], // default empty array
  });

  const [error, setError] = useState("");
  const [users, setUsers] = useState([]);

  useEffect(() => {
    if (open) {
      getPublicUsers()
        .then((data) => setUsers(data))
        .catch((err) => {
          console.error("âŒ Error loading users:", err);
          setUsers([]);
        });
    }
  }, [open]);

  /**
   * Handles form field changes.
   *
   * @param {string} field - Field name to update.
   * @param {string} value - New value for the field.
   */
  const handleChange = (field, value) => {
    setForm((prev) => ({ ...prev, [field]: value }));
  };

  /**
   * Creates a new Kanban task by sending payload to backend.
   *
   * @async
   * @param {Object} formData - Form data containing task details.
   * @param {string} formData.title - Task title.
   * @param {string} formData.description - Task description.
   * @param {string} formData.status - Task status ("todo", "in_progress", "review", "done").
   * @param {string} formData.assignedTo - ID of the assigned user.
   * @param {string} formData.priority - Task priority ("high", "medium", "low").
   * @param {string} [formData.deadline] - Optional deadline date string.
   * @param {Array&lt;string>} [formData.tags] - Optional tags for the task.
   * @returns {Promise&lt;void>} Resolves when the task is successfully created.
   */
  const createTask = async (formData) => {
    try {
      const payload = {
        title: formData.title,
        description: formData.description,
        status: formData.status,
        projectId,
        deadline: formData.deadline ? new Date(formData.deadline).toISOString() : null,
        assignees: formData.assignedTo ? [formData.assignedTo] : [],
        priority: formData.priority,
        tags: formData.tags,
        source: "kanban",
      };

      const data = await createKanbanTask(listId, payload);
      onTaskAdded(data);
      onClose();
    } catch (err) {
      console.error("âŒ Error creating Kanban task:", err.message);
      setError("There was a problem creating the task.");
    }
  };

  /**
   * Validates form fields and triggers task creation.
   *
   * @async
   * @returns {Promise&lt;void>} Resolves when validation passes and task is created.
   */
  const handleSubmit = async () => {
    const { title, description, assignedTo, status, priority, deadline } = form;

    if (!title?.trim()) {
      setError("âš ï¸ Title is required.");
      return;
    }

    if (!description?.trim()) {
      setError("âš ï¸ Description is required.");
      return;
    }

    if (!assignedTo) {
      setError("âš ï¸ You must assign the task to a user.");
      return;
    }

    if (!listId || !projectId) {
      setError("âš ï¸ Missing project or list information.");
      return;
    }

    const validStatuses = ["todo", "in_progress", "review", "done"];
    if (!status || !validStatuses.includes(status)) {
      setError("âš ï¸ Invalid task status.");
      return;
    }

    const validPriorities = ["high", "medium", "low"];
    if (!priority || !validPriorities.includes(priority)) {
      setError("âš ï¸ Priority must be high, medium, or low.");
      return;
    }

    if (deadline &amp;&amp; isNaN(new Date(deadline).getTime())) {
      setError("âš ï¸ Invalid deadline date.");
      return;
    }

    try {
      await createTask(form);
      setError("");
    } catch (err) {
      console.error("âŒ Error creating task:", err);
      setError("There was a problem creating the task.");
    }
  };

  return (
    &lt;Modal open={open} onClose={onClose}>
      {/* Modal content */}
      &lt;Box
        sx={{
          width: 400,
          maxHeight: "80vh",
          overflowY: "auto",
          bgcolor: "background.paper",
          p: 4,
          mx: "auto",
          mt: "5%",
          borderRadius: 2,
          position: "relative",
        }}
      >
        {/* Close button */}
        &lt;IconButton
          aria-label="close"
          onClick={onClose}
          sx={{
            position: "absolute",
            right: 8,
            top: 8,
            color: (theme) => theme.palette.grey[500],
          }}
        >
          &lt;CloseIcon />
        &lt;/IconButton>

        &lt;Typography variant="h6" gutterBottom>
          âž• Add Kanban Task
        &lt;/Typography>
        {error &amp;&amp; (
          &lt;Typography color="error" sx={{ mb: 2 }}>
            {error}
          &lt;/Typography>
        )}

        {/* Form fields */}
        {/* Title */}
        &lt;TextField
          label="ðŸ“ Title"
          fullWidth
          required
          value={form.title}
          onChange={(e) => handleChange("title", e.target.value)}
          sx={{ mb: 2 }}
        />
        {/* Description */}
        &lt;TextField
          label="ðŸ“„ Description"
          fullWidth
          multiline
          rows={3}
          required
          value={form.description}
          onChange={(e) => handleChange("description", e.target.value)}
          sx={{ mb: 2 }}
        />

        {/* Status */}
        &lt;FormControl fullWidth sx={{ mb: 2 }}>
          &lt;InputLabel>Status&lt;/InputLabel>
          &lt;Select
            value={form.status}
            label="Status"
            onChange={(e) => handleChange("status", e.target.value)}
          >
            &lt;MenuItem value="todo">ðŸ“ To Do&lt;/MenuItem>
            &lt;MenuItem value="in_progress">ðŸ”„ In Progress&lt;/MenuItem>
            &lt;MenuItem value="review">ðŸ‘€ Review&lt;/MenuItem>
            &lt;MenuItem value="done">âœ… Done&lt;/MenuItem>
          &lt;/Select>
        &lt;/FormControl>

        {/* Assigned To */}
        &lt;FormControl fullWidth sx={{ mb: 2 }}>
          &lt;InputLabel>Assigned To&lt;/InputLabel>
          &lt;Select
            value={form.assignedTo}
            onChange={(e) => handleChange("assignedTo", e.target.value)}
          >
            {users.length === 0 ? (
              &lt;MenuItem disabled>ðŸš« No users available&lt;/MenuItem>
            ) : (
              users.map((user) => (
                &lt;MenuItem key={user._id} value={user._id}>
                  &lt;Box>
                    &lt;Typography variant="body1">ðŸ‘¤ {user.username}&lt;/Typography>
                    &lt;Typography variant="caption" color="text.secondary">
                      ðŸ“§ {user.email}
                    &lt;/Typography>
                  &lt;/Box>
                &lt;/MenuItem>
              ))
            )}
          &lt;/Select>
        &lt;/FormControl>

        {/* Priority */}
        &lt;FormControl fullWidth sx={{ mb: 2 }}>
          &lt;InputLabel>Priority&lt;/InputLabel>
          &lt;Select
            value={form.priority || "medium"}
            onChange={(e) => handleChange("priority", e.target.value)}
          >
                       &lt;MenuItem value="high">âš¡ High&lt;/MenuItem>
            &lt;MenuItem value="medium">ðŸ“Š Medium&lt;/MenuItem>
            &lt;MenuItem value="low">ðŸ¢ Low&lt;/MenuItem>
          &lt;/Select>
        &lt;/FormControl>

        {/* Deadline */}
        &lt;TextField
          label="ðŸ“… Deadline"
          type="date"
          fullWidth
          InputLabelProps={{ shrink: true }}
          value={form.deadline || ""}
          onChange={(e) => handleChange("deadline", e.target.value)}
          sx={{ mb: 2 }}
        />

        {/* Action buttons */}
        &lt;Box sx={{ display: "flex", justifyContent: "flex-end", gap: 1 }}>
          &lt;Button variant="outlined" onClick={onClose}>
            âŒ Cancel
          &lt;/Button>
          &lt;Button variant="contained" onClick={handleSubmit}>
            âœ… Create
          &lt;/Button>
        &lt;/Box>
      &lt;/Box>
    &lt;/Modal>
  );
};

export default AddKanbanTaskModal;
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="babel.module_config.html">babel.config</a></li><li><a href="eslint.module_config.html">eslint.config</a></li><li><a href="jest.module_config.html">jest.config</a></li><li><a href="jest.module_setup.html">jest.setup</a></li><li><a href="module-ColorModeContext.html">ColorModeContext</a></li><li><a href="module-ThemeWrapper.html">ThemeWrapper</a></li><li><a href="module-auth_roles.html">auth/roles</a></li><li><a href="module-auth_useFirebaseAuth.html">auth/useFirebaseAuth</a></li><li><a href="module-components_AssistantSidebar.html">components/AssistantSidebar</a></li><li><a href="module-components_AuthProviderButton.html">components/AuthProviderButton</a></li><li><a href="module-components_Column.html">components/Column</a></li><li><a href="module-components_ColumnDroppable.html">components/ColumnDroppable</a></li><li><a href="module-components_EditorPanel.html">components/EditorPanel</a></li><li><a href="module-components_ErrorBoundaryWrapper.html">components/ErrorBoundaryWrapper</a></li><li><a href="module-components_FileTree.html">components/FileTree</a></li><li><a href="module-components_Footer.html">components/Footer</a></li><li><a href="module-components_FormCard.html">components/FormCard</a></li><li><a href="module-components_Input.html">components/Input</a></li><li><a href="module-components_KanbanModals.html">components/KanbanModals</a></li><li><a href="module-components_KanbanOverlay.html">components/KanbanOverlay</a></li><li><a href="module-components_KanbanTaskPreview.html">components/KanbanTaskPreview</a></li><li><a href="module-components_KanbanUtils.html">components/KanbanUtils</a></li><li><a href="module-components_Loading.html">components/Loading</a></li><li><a href="module-components_LocalTaskPanel.html">components/LocalTaskPanel</a></li><li><a href="module-components_Logo.html">components/Logo</a></li><li><a href="module-components_OutputPanel.html">components/OutputPanel</a></li><li><a href="module-components_PersonalTaskPreview.html">components/PersonalTaskPreview</a></li><li><a href="module-components_PersonalTasksPanel.html">components/PersonalTasksPanel</a></li><li><a href="module-components_ProjectSelector.html">components/ProjectSelector</a></li><li><a href="module-components_ProjectSummaryDashboard.html">components/ProjectSummaryDashboard</a></li><li><a href="module-components_RedirectHandler.html">components/RedirectHandler</a></li><li><a href="module-components_SortableTask.html">components/SortableTask</a></li><li><a href="module-components_SuspenseWrapper.html">components/SuspenseWrapper</a></li><li><a href="module-components_TaskCard.html">components/TaskCard</a></li><li><a href="module-components_TaskComments.html">components/TaskComments</a></li><li><a href="module-components_TaskFilters.html">components/TaskFilters</a></li><li><a href="module-components_TerminalPanel.html">components/TerminalPanel</a></li><li><a href="module-components_UserProfilePanel.html">components/UserProfilePanel</a></li><li><a href="module-components_modals_AddKanbanTaskModal.html">components/modals/AddKanbanTaskModal</a></li><li><a href="module-components_modals_AddTaskModal.html">components/modals/AddTaskModal</a></li><li><a href="module-components_modals_DeleteTaskModal.html">components/modals/DeleteTaskModal</a></li><li><a href="module-components_modals_EditLocalTaskModal.html">components/modals/EditLocalTaskModal</a></li><li><a href="module-components_modals_EditTaskModal.html">components/modals/EditTaskModal</a></li><li><a href="module-components_modals_LogoutModal.html">components/modals/LogoutModal</a></li><li><a href="module-components_modals_NewKanbanListModal.html">components/modals/NewKanbanListModal</a></li><li><a href="module-components_modals_NewListModal.html">components/modals/NewListModal</a></li><li><a href="module-components_modals_NewProjectModal.html">components/modals/NewProjectModal</a></li><li><a href="module-components_modals_ProjectDetailModal.html">components/modals/ProjectDetailModal</a></li><li><a href="module-components_modals_TaskDetailModal.html">components/modals/TaskDetailModal</a></li><li><a href="module-components_navbar_NavCategory.html">components/navbar/NavCategory</a></li><li><a href="module-components_navbar_Navbar.html">components/navbar/Navbar</a></li><li><a href="module-components_navbar_navDropdowns.html">components/navbar/navDropdowns</a></li><li><a href="module-context_AuthContext.html">context/AuthContext</a></li><li><a href="module-context_AuthProvider.html">context/AuthProvider</a></li><li><a href="module-context_ModalContext.html">context/ModalContext</a></li><li><a href="module-context_ModalProvider.html">context/ModalProvider</a></li><li><a href="module-firebase_auth.html">firebase/auth</a></li><li><a href="module-firebase_authUtils.html">firebase/authUtils</a></li><li><a href="module-hooks_init.html">hooks/init</a></li><li><a href="module-hooks_useAuth.html">hooks/useAuth</a></li><li><a href="module-hooks_useModal.html">hooks/useModal</a></li><li><a href="module-hooks_useUser.html">hooks/useUser</a></li><li><a href="module-hooks_utilsAuth.html">hooks/utilsAuth</a></li><li><a href="module-layouts_PrivateLayout.html">layouts/PrivateLayout</a></li><li><a href="module-layouts_PublicLayout.html">layouts/PublicLayout</a></li><li><a href="module-layouts_RootLayout.html">layouts/RootLayout</a></li><li><a href="module-main.html">main</a></li><li><a href="module-pages_AdminUserPanel.html">pages/AdminUserPanel</a></li><li><a href="module-pages_CodeReviewPanel.html">pages/CodeReviewPanel</a></li><li><a href="module-pages_CollaborativeCodeEditor.html">pages/CollaborativeCodeEditor</a></li><li><a href="module-pages_Dashboard.html">pages/Dashboard</a></li><li><a href="module-pages_KanbanBoard.html">pages/KanbanBoard</a></li><li><a href="module-pages_LocalTaskBoard.html">pages/LocalTaskBoard</a></li><li><a href="module-pages_MyProjects.html">pages/MyProjects</a></li><li><a href="module-pages_NotFound.html">pages/NotFound</a></li><li><a href="module-pages_PersonalTasksBoard.html">pages/PersonalTasksBoard</a></li><li><a href="module-pages_Profile.html">pages/Profile</a></li><li><a href="module-pages_ProjectDashboard.html">pages/ProjectDashboard</a></li><li><a href="module-pages_ProjectDocumentation.html">pages/ProjectDocumentation</a></li><li><a href="module-pages_ProjectManagementDashboard.html">pages/ProjectManagementDashboard</a></li><li><a href="module-pages_Settings.html">pages/Settings</a></li><li><a href="module-pages_TasksPage.html">pages/TasksPage</a></li><li><a href="module-pages_TeamChatModule.html">pages/TeamChatModule</a></li><li><a href="module-pages_docs_QuickStartGuide.html">pages/docs/QuickStartGuide</a></li><li><a href="module-pages_public__HelpCenter.html">pages/public//HelpCenter</a></li><li><a href="module-pages_public_AIAssistant.html">pages/public/AIAssistant</a></li><li><a href="module-pages_public_Blog.html">pages/public/Blog</a></li><li><a href="module-pages_public_ContactSupport.html">pages/public/ContactSupport</a></li><li><a href="module-pages_public_Features.html">pages/public/Features</a></li><li><a href="module-pages_public_ForDevelopers.html">pages/public/ForDevelopers</a></li><li><a href="module-pages_public_Home.html">pages/public/Home</a></li><li><a href="module-pages_public_PrivacyPolicy.html">pages/public/PrivacyPolicy</a></li><li><a href="module-pages_public_SignIn.html">pages/public/SignIn</a></li><li><a href="module-pages_public_SignUp.html">pages/public/SignUp</a></li><li><a href="module-pages_public_TermsOfService.html">pages/public/TermsOfService</a></li><li><a href="module-pages_public_Testimonials.html">pages/public/Testimonials</a></li><li><a href="module-routes_AdminDashboardRoutes.html">routes/AdminDashboardRoutes</a></li><li><a href="module-routes_AdminRoutes.html">routes/AdminRoutes</a></li><li><a href="module-routes_DashboardRoutes.html">routes/DashboardRoutes</a></li><li><a href="module-routes_IndexRoute.html">routes/IndexRoute</a></li><li><a href="module-routes_ModalRoutes.html">routes/ModalRoutes</a></li><li><a href="module-routes_ProtectedRoute.html">routes/ProtectedRoute</a></li><li><a href="module-routes_PublicRoutes.html">routes/PublicRoutes</a></li><li><a href="module-routes_Routes.html">routes/Routes</a></li><li><a href="module-services_assistantService.html">services/assistantService</a></li><li><a href="module-services_auth_handleLoginRedirect.html">services/auth/handleLoginRedirect</a></li><li><a href="module-services_auth_logoutRequest.html">services/auth/logoutRequest</a></li><li><a href="module-services_auth_roleUtils.html">services/auth/roleUtils</a></li><li><a href="module-services_auth_signInAuth.html">services/auth/signInAuth</a></li><li><a href="module-services_auth_signUpAuth.html">services/auth/signUpAuth</a></li><li><a href="module-services_avatarService.html">services/avatarService</a></li><li><a href="module-services_editorServices.html">services/editorServices</a></li><li><a href="module-services_fileService.html">services/fileService</a></li><li><a href="module-services_kanbanService.html">services/kanbanService</a></li><li><a href="module-services_profileService.html">services/profileService</a></li><li><a href="module-services_projectService.html">services/projectService</a></li><li><a href="module-services_taskService.html">services/taskService</a></li><li><a href="module-services_userService.html">services/userService</a></li><li><a href="module-theme.html">theme</a></li><li><a href="module-utils_authUtils.html">utils/authUtils</a></li><li><a href="module-utils_axiosConfig.html">utils/axiosConfig</a></li><li><a href="module-utils_cleanMentorOutput.html">utils/cleanMentorOutput</a></li><li><a href="module-utils_getRedirectForRole.html">utils/getRedirectForRole</a></li><li><a href="module-utils_monacoConfig.html">utils/monacoConfig</a></li><li><a href="module-utils_syncUserAndRedirect.html">utils/syncUserAndRedirect</a></li><li><a href="module-utils_taskUtils.html">utils/taskUtils</a></li><li><a href="module-utils_userToken.html">utils/userToken</a></li><li><a href="module-views_unauthorized.html">views/unauthorized</a></li><li><a href="vite.module_config.html">vite.config</a></li></ul><h3>Classes</h3><ul><li><a href="-_src_server_project.ts_-ConfiguredProject2.html">ConfiguredProject2</a></li><li><a href="-_src_server_project.ts_-ExternalProject2.html">ExternalProject2</a></li><li><a href="-_src_server_project.ts_-InferredProject2.html">InferredProject2</a></li><li><a href="-_src_server_project.ts_-Project3.html">Project3</a></li><li><a href="-_src_server_project.ts_-_AutoImportProviderProject.html">_AutoImportProviderProject</a></li><li><a href="-_src_services_textChanges.ts_-ChangeTracker.html">ChangeTracker</a></li><li><a href="module-components_ErrorBoundaryWrapper-ErrorBoundaryWrapper.html">ErrorBoundaryWrapper</a></li></ul><h3>Events</h3><ul><li><a href="module-utils_userToken.html#~event:onIdTokenChanged">onIdTokenChanged</a></li></ul><h3>Global</h3><ul><li><a href="global.html#renderWithRouter">renderWithRouter</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.5</a> on Sat Feb 14 2026 12:39:54 GMT+0000 (Coordinated Universal Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
