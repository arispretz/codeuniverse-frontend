<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: src/layouts/PrivateLayout.jsx</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: src/layouts/PrivateLayout.jsx</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @fileoverview PrivateLayout component.
 * Provides the main layout for authenticated users, including:
 * - AppBar with logo, workspace title, user greeting, avatar, theme toggle, and user menu
 * - Sidebar navigation with role-based items
 * - Main content area with React Router Outlet
 * - Logout modal for session termination
 *
 * @module layouts/PrivateLayout
 */

import React, { useState, useRef, useContext } from "react";
import PropTypes from "prop-types";
import {
  AppBar,
  Toolbar,
  Drawer,
  Box,
  Typography,
  IconButton,
  Avatar,
  List,
  ListItemButton,
  ListItemText,
  ListItemIcon,
  Menu,
  MenuItem,
  Divider,
  CircularProgress,
} from "@mui/material";
import {
  Dashboard,
  People,
  Code,
  Assignment,
  HelpOutline,
  BarChart,
  Logout as LogoutIcon,
} from "@mui/icons-material";
import { Link, useNavigate, Outlet } from "react-router-dom";
import ThemeToggleButton from "../ThemeToggleButton";
import Logo from "../components/Logo.jsx";
import { useTheme } from "@mui/material/styles";
import LogoutModal from "../components/modals/LogoutModal.jsx";
import { signOut } from "firebase/auth";
import { auth } from "../firebase/auth.js";
import { AuthContext } from "../context/AuthContext.jsx";

const drawerWidth = 200;

/**
 * Returns sidebar items based on user role.
 *
 * @function getSidebarItems
 * @param {string} role - User role (`admin`, `manager`, `developer`, `guest`).
 * @returns {Array&lt;Object>} List of sidebar items with label, route, and icon.
 */
const getSidebarItems = (role) => {
  const common = [
    { label: "Dashboard", to: "/dashboard", icon: &lt;Dashboard /> },
    { label: "Kanban Board", to: "/dashboard/kanban", icon: &lt;Assignment /> },
    { label: "Local Task Board", to: "/dashboard/local-task-board", icon: &lt;Assignment /> },
    { label: "Personal Tasks", to: "/dashboard/personal-tasks", icon: &lt;Assignment /> },
    { label: "Collaborative Code Editor", to: "/dashboard/editor", icon: &lt;Assignment /> },
    { label: "Team Chat", to: "/dashboard/team-chat", icon: &lt;People /> },
    { label: "Code Review Panel", to: "/dashboard/code-review", icon: &lt;Code /> },
    { label: "Project Documentation", to: "/dashboard/project-docs", icon: &lt;Code /> },
  ];

  const adminExtras = [
    { label: "Project Dashboard", to: "/dashboard/project-dashboard", icon: &lt;BarChart /> },
    { label: "Project Management Dashboard", to: "/dashboard/manager/projects", icon: &lt;Code /> },
    { label: "Admin User Panel", to: "/dashboard/admin-user-panel", icon: &lt;BarChart /> },
  ];

  const managerExtras = [
    { label: "Project Dashboard", to: "/dashboard/project-dashboard", icon: &lt;BarChart /> },
    { label: "Project Management Dashboard", to: "/dashboard/manager/projects", icon: &lt;Code /> },
  ];

  const developerExtras = [
    { label: "My Projects", to: "/dashboard/my-projects", icon: &lt;Assignment /> },
  ];

  const guestExtras = [
    { label: "Quick Start Guide", to: "/dashboard/quick-start-guide", icon: &lt;HelpOutline /> },
  ];

  switch (role) {
    case "admin":
      return [...common, ...adminExtras];
    case "manager":
      return [...common, ...managerExtras];
    case "developer":
      return [...common, ...developerExtras];
    case "guest":
      return [
        { label: "Dashboard", to: "/dashboard", icon: &lt;Dashboard /> },
        ...guestExtras
      ];
    default:
      return guestExtras;
  }
  };

/**
 * PrivateLayout Component
 *
 * @function PrivateLayout
 * @param {Object} props - Component props.
 * @param {React.ReactNode} props.children - Main content rendered inside the layout.
 * @param {Object} props.user - Authenticated user object.
 * @param {string} props.user.displayName - User's display name.
 * @param {string} props.user.photoURL - User's avatar URL.
 * @param {string} props.user.role - User's role (`admin`, `manager`, `developer`, `guest`).
 * @returns {JSX.Element} Complete layout with AppBar, sidebar navigation, and main content.
 *
 * @example
 * &lt;PrivateLayout>
 *   &lt;Dashboard />
 * &lt;/PrivateLayout>
 */
export function PrivateLayout({ children }) {
  const { user, setUser, setRole } = useContext(AuthContext);
  const [anchorEl, setAnchorEl] = useState(null);
  const openMenu = Boolean(anchorEl);
  const theme = useTheme();
  const navigate = useNavigate();
  const avatarButtonRef = useRef();
  const [logoutOpen, setLogoutOpen] = useState(false);
  const [logoutLoading, setLogoutLoading] = useState(false);

  const handleMenuOpen = (event) => setAnchorEl(event.currentTarget);
  const handleMenuClose = () => {
    setAnchorEl(null);
    avatarButtonRef.current?.focus();
  };

  /**
   * Handles user logout.
   *
   * @async
   * @function handleLogout
   * @returns {Promise&lt;void>}
   */
  const handleLogout = async () => {
    setLogoutLoading(true);
    try {
      await signOut(auth);
      localStorage.removeItem("token");
      localStorage.removeItem("role");
      setUser(null);
      setRole(null);
      navigate("/sign-in");
    } catch (err) {
      console.error("Logout error:", err);
    } finally {
      setLogoutLoading(false);
      setLogoutOpen(false);
    }
  };

  const normalizedRole = user?.role?.toLowerCase().trim() || "guest";
  const sidebarItems = getSidebarItems(normalizedRole);

  if (!user || !user.role) {
    return (
      &lt;Box sx={{ p: 4 }}>
        &lt;CircularProgress />
        &lt;Typography sx={{ mt: 2 }}>Loading workspace...&lt;/Typography>
      &lt;/Box>
    );
  }

  return (
    &lt;Box sx={{ display: "flex", minHeight: "100vh", bgcolor: "background.default" }}>
      {/* AppBar with logo, workspace title, user greeting, avatar, and theme toggle */}
      &lt;AppBar
        position="fixed"
        sx={{
          zIndex: theme.zIndex.drawer + 1,
          backgroundColor: theme.palette.navbar?.background || theme.palette.primary.main,
          color: theme.palette.navbar?.background || theme.palette.secondary.main,
        }}
      >
        &lt;Toolbar sx={{ minHeight: 50, height: 85, px: 3, justifyContent: "space-between" }}>
          &lt;Box sx={{ display: "flex", alignItems: "baseline", gap: 2 }}>
            &lt;Logo />
            &lt;Typography variant="h6" noWrap sx={{ fontSize: "1.25rem" }}>
              My Workspace
            &lt;/Typography>
          &lt;/Box>

          &lt;Box sx={{ display: "flex", alignItems: "center", gap: 2 }}>
            &lt;Typography variant="body2" sx={{ fontSize: "0.95rem" }}>
              Hi, {user?.displayName || "Guest"}!
            &lt;/Typography>
            &lt;IconButton
              ref={avatarButtonRef}
              onClick={handleMenuOpen}
              aria-label="Open user menu"
            >
              &lt;Avatar src={user?.photoURL || ""} alt={user?.displayName || "Guest"} />
            &lt;/IconButton>
            &lt;ThemeToggleButton />
          &lt;/Box>

          {/* User Menu with profile/settings links and logout */}
          &lt;Menu
            anchorEl={anchorEl}
            open={openMenu}
            onClose={handleMenuClose}
            disableAutoFocusItem
            disableEnforceFocus
            MenuListProps={{ autoFocus: false }}
          >
            {(user?.role !== "guest"
              ? [
                  { label: "Profile", to: "/dashboard/profile" },
                  { label: "Settings", to: "/dashboard/settings" },
                  { label: "My Projects", to: "/dashboard/my-projects" },
                  { label: "Personal Tasks", to: "/dashboard/personal-tasks" },
                ]
              : [
                  { label: "Quick Start Guide", to: "docs/quick-start" },
                ]
            ).map(({ label, to }, index) => (
              &lt;MenuItem
                key={index}
                component={Link}
                to={to}
                onClick={handleMenuClose}
                autoFocus={false}
              >
                {label}
              &lt;/MenuItem>
            ))}

            &lt;Divider />
            &lt;MenuItem
              onClick={() => {
                handleMenuClose();
                setTimeout(() => setLogoutOpen(true), 100);
              }}
              sx={{ color: "error.main" }}
              autoFocus={false}
            >
              &lt;ListItemIcon>
                &lt;LogoutIcon fontSize="small" sx={{ color: "error.main" }} />
              &lt;/ListItemIcon>
              Logout
            &lt;/MenuItem>
          &lt;/Menu>
        &lt;/Toolbar>
      &lt;/AppBar>

            {/* Sidebar Drawer with role-based navigation */}
      &lt;Drawer
        variant="permanent"
        sx={{
          width: drawerWidth,
          flexShrink: 0,
          [`&amp; .MuiDrawer-paper`]: {
            width: drawerWidth,
            boxSizing: "border-box",
          },
        }}
      >
        &lt;Toolbar />
        &lt;List sx={{ mt: 2 }}>
          {sidebarItems.map(({ label, to, icon }, index) => (
            &lt;ListItemButton key={index} component={Link} to={to}>
              &lt;ListItemIcon>{icon}&lt;/ListItemIcon>
              &lt;ListItemText
                primary={label}
                primaryTypographyProps={{
                  fontSize: "0.95rem",
                  sx: { color: "text.primary" },
                }}
              />
            &lt;/ListItemButton>
          ))}
        &lt;/List>
      &lt;/Drawer>

      {/* Main Content Area */}
      &lt;Box
        component="main"
        sx={{
          flexGrow: 5,
          pr: 20,
          maxWidth: `calc(100% - ${drawerWidth}px)`,
          overflowX: "hidden",
        }}
      >
        &lt;Toolbar />
        &lt;Box sx={{ display: "flex", justifyContent: "space-evenly" }}>
          &lt;Box sx={{ display: "flex", flexDirection: "column", width: "100%", overflowX: "hidden" }}>
            {/* React Router Outlet renders child routes here */}
            &lt;Outlet />
          &lt;/Box>
        &lt;/Box>
      &lt;/Box>

      {/* Logout Modal */}
      &lt;LogoutModal
        open={logoutOpen}
        onConfirm={handleLogout}
        onCancel={() => setLogoutOpen(false)}
        loading={logoutLoading}
      />
    &lt;/Box>
  );
}

PrivateLayout.propTypes = {
  /** Child components rendered inside the layout */
  children: PropTypes.node.isRequired,
  /** Authenticated user object */
  user: PropTypes.shape({
    displayName: PropTypes.string,
    photoURL: PropTypes.string,
    role: PropTypes.string,
  }),
};

export default PrivateLayout;
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="babel.module_config.html">babel.config</a></li><li><a href="eslint.module_config.html">eslint.config</a></li><li><a href="jest.module_config.html">jest.config</a></li><li><a href="jest.module_setup.html">jest.setup</a></li><li><a href="module-ColorModeContext.html">ColorModeContext</a></li><li><a href="module-ThemeWrapper.html">ThemeWrapper</a></li><li><a href="module-auth_roles.html">auth/roles</a></li><li><a href="module-auth_useFirebaseAuth.html">auth/useFirebaseAuth</a></li><li><a href="module-components_AssistantSidebar.html">components/AssistantSidebar</a></li><li><a href="module-components_AuthProviderButton.html">components/AuthProviderButton</a></li><li><a href="module-components_Column.html">components/Column</a></li><li><a href="module-components_ColumnDroppable.html">components/ColumnDroppable</a></li><li><a href="module-components_EditorPanel.html">components/EditorPanel</a></li><li><a href="module-components_ErrorBoundaryWrapper.html">components/ErrorBoundaryWrapper</a></li><li><a href="module-components_FileTree.html">components/FileTree</a></li><li><a href="module-components_Footer.html">components/Footer</a></li><li><a href="module-components_FormCard.html">components/FormCard</a></li><li><a href="module-components_Input.html">components/Input</a></li><li><a href="module-components_KanbanModals.html">components/KanbanModals</a></li><li><a href="module-components_KanbanOverlay.html">components/KanbanOverlay</a></li><li><a href="module-components_KanbanTaskPreview.html">components/KanbanTaskPreview</a></li><li><a href="module-components_KanbanUtils.html">components/KanbanUtils</a></li><li><a href="module-components_Loading.html">components/Loading</a></li><li><a href="module-components_LocalTaskPanel.html">components/LocalTaskPanel</a></li><li><a href="module-components_Logo.html">components/Logo</a></li><li><a href="module-components_OutputPanel.html">components/OutputPanel</a></li><li><a href="module-components_PersonalTaskPreview.html">components/PersonalTaskPreview</a></li><li><a href="module-components_PersonalTasksPanel.html">components/PersonalTasksPanel</a></li><li><a href="module-components_ProjectSelector.html">components/ProjectSelector</a></li><li><a href="module-components_ProjectSummaryDashboard.html">components/ProjectSummaryDashboard</a></li><li><a href="module-components_RedirectHandler.html">components/RedirectHandler</a></li><li><a href="module-components_SortableTask.html">components/SortableTask</a></li><li><a href="module-components_SuspenseWrapper.html">components/SuspenseWrapper</a></li><li><a href="module-components_TaskCard.html">components/TaskCard</a></li><li><a href="module-components_TaskComments.html">components/TaskComments</a></li><li><a href="module-components_TaskFilters.html">components/TaskFilters</a></li><li><a href="module-components_TerminalPanel.html">components/TerminalPanel</a></li><li><a href="module-components_UserProfilePanel.html">components/UserProfilePanel</a></li><li><a href="module-components_modals_AddKanbanTaskModal.html">components/modals/AddKanbanTaskModal</a></li><li><a href="module-components_modals_AddTaskModal.html">components/modals/AddTaskModal</a></li><li><a href="module-components_modals_DeleteTaskModal.html">components/modals/DeleteTaskModal</a></li><li><a href="module-components_modals_EditLocalTaskModal.html">components/modals/EditLocalTaskModal</a></li><li><a href="module-components_modals_EditTaskModal.html">components/modals/EditTaskModal</a></li><li><a href="module-components_modals_LogoutModal.html">components/modals/LogoutModal</a></li><li><a href="module-components_modals_NewKanbanListModal.html">components/modals/NewKanbanListModal</a></li><li><a href="module-components_modals_NewListModal.html">components/modals/NewListModal</a></li><li><a href="module-components_modals_NewProjectModal.html">components/modals/NewProjectModal</a></li><li><a href="module-components_modals_ProjectDetailModal.html">components/modals/ProjectDetailModal</a></li><li><a href="module-components_modals_TaskDetailModal.html">components/modals/TaskDetailModal</a></li><li><a href="module-components_navbar_NavCategory.html">components/navbar/NavCategory</a></li><li><a href="module-components_navbar_Navbar.html">components/navbar/Navbar</a></li><li><a href="module-components_navbar_navDropdowns.html">components/navbar/navDropdowns</a></li><li><a href="module-context_AuthContext.html">context/AuthContext</a></li><li><a href="module-context_AuthProvider.html">context/AuthProvider</a></li><li><a href="module-context_ModalContext.html">context/ModalContext</a></li><li><a href="module-context_ModalProvider.html">context/ModalProvider</a></li><li><a href="module-firebase_auth.html">firebase/auth</a></li><li><a href="module-firebase_authUtils.html">firebase/authUtils</a></li><li><a href="module-hooks_init.html">hooks/init</a></li><li><a href="module-hooks_useAuth.html">hooks/useAuth</a></li><li><a href="module-hooks_useModal.html">hooks/useModal</a></li><li><a href="module-hooks_useUser.html">hooks/useUser</a></li><li><a href="module-hooks_utilsAuth.html">hooks/utilsAuth</a></li><li><a href="module-layouts_PrivateLayout.html">layouts/PrivateLayout</a></li><li><a href="module-layouts_PublicLayout.html">layouts/PublicLayout</a></li><li><a href="module-layouts_RootLayout.html">layouts/RootLayout</a></li><li><a href="module-main.html">main</a></li><li><a href="module-pages_AdminUserPanel.html">pages/AdminUserPanel</a></li><li><a href="module-pages_CodeReviewPanel.html">pages/CodeReviewPanel</a></li><li><a href="module-pages_CollaborativeCodeEditor.html">pages/CollaborativeCodeEditor</a></li><li><a href="module-pages_Dashboard.html">pages/Dashboard</a></li><li><a href="module-pages_KanbanBoard.html">pages/KanbanBoard</a></li><li><a href="module-pages_LocalTaskBoard.html">pages/LocalTaskBoard</a></li><li><a href="module-pages_MyProjects.html">pages/MyProjects</a></li><li><a href="module-pages_NotFound.html">pages/NotFound</a></li><li><a href="module-pages_PersonalTasksBoard.html">pages/PersonalTasksBoard</a></li><li><a href="module-pages_Profile.html">pages/Profile</a></li><li><a href="module-pages_ProjectDashboard.html">pages/ProjectDashboard</a></li><li><a href="module-pages_ProjectDocumentation.html">pages/ProjectDocumentation</a></li><li><a href="module-pages_ProjectManagementDashboard.html">pages/ProjectManagementDashboard</a></li><li><a href="module-pages_Settings.html">pages/Settings</a></li><li><a href="module-pages_TasksPage.html">pages/TasksPage</a></li><li><a href="module-pages_TeamChatModule.html">pages/TeamChatModule</a></li><li><a href="module-pages_docs_QuickStartGuide.html">pages/docs/QuickStartGuide</a></li><li><a href="module-pages_public__HelpCenter.html">pages/public//HelpCenter</a></li><li><a href="module-pages_public_AIAssistant.html">pages/public/AIAssistant</a></li><li><a href="module-pages_public_Blog.html">pages/public/Blog</a></li><li><a href="module-pages_public_ContactSupport.html">pages/public/ContactSupport</a></li><li><a href="module-pages_public_Features.html">pages/public/Features</a></li><li><a href="module-pages_public_ForDevelopers.html">pages/public/ForDevelopers</a></li><li><a href="module-pages_public_Home.html">pages/public/Home</a></li><li><a href="module-pages_public_PrivacyPolicy.html">pages/public/PrivacyPolicy</a></li><li><a href="module-pages_public_SignIn.html">pages/public/SignIn</a></li><li><a href="module-pages_public_SignUp.html">pages/public/SignUp</a></li><li><a href="module-pages_public_TermsOfService.html">pages/public/TermsOfService</a></li><li><a href="module-pages_public_Testimonials.html">pages/public/Testimonials</a></li><li><a href="module-routes_AdminDashboardRoutes.html">routes/AdminDashboardRoutes</a></li><li><a href="module-routes_AdminRoutes.html">routes/AdminRoutes</a></li><li><a href="module-routes_DashboardRoutes.html">routes/DashboardRoutes</a></li><li><a href="module-routes_IndexRoute.html">routes/IndexRoute</a></li><li><a href="module-routes_ModalRoutes.html">routes/ModalRoutes</a></li><li><a href="module-routes_ProtectedRoute.html">routes/ProtectedRoute</a></li><li><a href="module-routes_PublicRoutes.html">routes/PublicRoutes</a></li><li><a href="module-routes_Routes.html">routes/Routes</a></li><li><a href="module-services_assistantService.html">services/assistantService</a></li><li><a href="module-services_auth_handleLoginRedirect.html">services/auth/handleLoginRedirect</a></li><li><a href="module-services_auth_logoutRequest.html">services/auth/logoutRequest</a></li><li><a href="module-services_auth_roleUtils.html">services/auth/roleUtils</a></li><li><a href="module-services_auth_signInAuth.html">services/auth/signInAuth</a></li><li><a href="module-services_auth_signUpAuth.html">services/auth/signUpAuth</a></li><li><a href="module-services_avatarService.html">services/avatarService</a></li><li><a href="module-services_editorServices.html">services/editorServices</a></li><li><a href="module-services_fileService.html">services/fileService</a></li><li><a href="module-services_kanbanService.html">services/kanbanService</a></li><li><a href="module-services_profileService.html">services/profileService</a></li><li><a href="module-services_projectService.html">services/projectService</a></li><li><a href="module-services_taskService.html">services/taskService</a></li><li><a href="module-services_userService.html">services/userService</a></li><li><a href="module-theme.html">theme</a></li><li><a href="module-utils_authUtils.html">utils/authUtils</a></li><li><a href="module-utils_axiosConfig.html">utils/axiosConfig</a></li><li><a href="module-utils_cleanMentorOutput.html">utils/cleanMentorOutput</a></li><li><a href="module-utils_getRedirectForRole.html">utils/getRedirectForRole</a></li><li><a href="module-utils_monacoConfig.html">utils/monacoConfig</a></li><li><a href="module-utils_syncUserAndRedirect.html">utils/syncUserAndRedirect</a></li><li><a href="module-utils_taskUtils.html">utils/taskUtils</a></li><li><a href="module-utils_userToken.html">utils/userToken</a></li><li><a href="module-views_unauthorized.html">views/unauthorized</a></li><li><a href="vite.module_config.html">vite.config</a></li></ul><h3>Classes</h3><ul><li><a href="-_src_server_project.ts_-ConfiguredProject2.html">ConfiguredProject2</a></li><li><a href="-_src_server_project.ts_-ExternalProject2.html">ExternalProject2</a></li><li><a href="-_src_server_project.ts_-InferredProject2.html">InferredProject2</a></li><li><a href="-_src_server_project.ts_-Project3.html">Project3</a></li><li><a href="-_src_server_project.ts_-_AutoImportProviderProject.html">_AutoImportProviderProject</a></li><li><a href="-_src_services_textChanges.ts_-ChangeTracker.html">ChangeTracker</a></li><li><a href="module-components_ErrorBoundaryWrapper-ErrorBoundaryWrapper.html">ErrorBoundaryWrapper</a></li></ul><h3>Events</h3><ul><li><a href="module-utils_userToken.html#~event:onIdTokenChanged">onIdTokenChanged</a></li></ul><h3>Global</h3><ul><li><a href="global.html#renderWithRouter">renderWithRouter</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.5</a> on Thu Feb 12 2026 12:04:01 GMT+0000 (Coordinated Universal Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
